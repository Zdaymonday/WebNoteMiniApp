{"ast":null,"code":"export const authModule = {\n  state: {\n    token: \"\"\n  },\n  mutations: {\n    setToken(state, token) {\n      state.token = token;\n    }\n  },\n  getters: {\n    isAuth(state, getters) {\n      return getters.getToken === \"\" ? false : true;\n    },\n    getToken(state) {\n      if (state.token) return state.token;\n      let token = sessionStorage.getItem('token');\n      if (token) return token;\n      return \"\";\n    }\n  },\n  actions: {\n    async login(context, credentials) {\n      let response = await fetch(\"https://localhost:7232/login\", {\n        method: \"Post\",\n        headers: {\n          \"Content-Type\": \"application/json\"\n        },\n        body: JSON.stringify(credentials)\n      });\n      if (response.ok) {\n        let text = await response.text();\n        text = text.replaceAll('\"', \"\");\n        context.commit(\"setToken\", text);\n        context.commit(\"login\");\n        sessionStorage.setItem('token', text);\n      } else {\n        this.hasErrors = true;\n      }\n    }\n  },\n  namespaced: true\n};","map":{"version":3,"names":["authModule","state","token","mutations","setToken","getters","isAuth","getToken","sessionStorage","getItem","actions","login","context","credentials","response","fetch","method","headers","body","JSON","stringify","ok","text","replaceAll","commit","setItem","hasErrors","namespaced"],"sources":["C:/Users/Администратор/source/repos/WebNoteMiniApp/webnoteminiapp.vue/src/Store/authModule.js"],"sourcesContent":["export const authModule = {\r\n    state: {\r\n        token: \"\",\r\n    },\r\n\r\n    mutations: {\r\n        setToken(state, token){\r\n            state.token = token;\r\n        },\r\n    },\r\n\r\n    getters: {\r\n        isAuth(state, getters){\r\n            return getters.getToken === \"\" ? false : true;\r\n        },\r\n        getToken(state){            \r\n            if(state.token) return state.token;\r\n            let token = sessionStorage.getItem('token');\r\n            if(token) return token;\r\n            return \"\";\r\n        }\r\n    },\r\n\r\n    actions: {\r\n        async login(context, credentials) {\r\n            let response = await fetch(\"https://localhost:7232/login\", {\r\n                method: \"Post\",\r\n                headers: {\"Content-Type\": \"application/json\"},\r\n                body: JSON.stringify(credentials),\r\n            });\r\n            if (response.ok) {\r\n                let text = await response.text();\r\n                text = text.replaceAll('\"',\"\");\r\n                context.commit(\"setToken\", text);\r\n                context.commit(\"login\");\r\n                sessionStorage.setItem('token',text);\r\n            }\r\n            else{\r\n                this.hasErrors = true;\r\n            }\r\n        }\r\n    },\r\n\r\n    namespaced: true,\r\n}"],"mappings":"AAAA,OAAO,MAAMA,UAAU,GAAG;EACtBC,KAAK,EAAE;IACHC,KAAK,EAAE;EACX,CAAC;EAEDC,SAAS,EAAE;IACPC,QAAQ,CAACH,KAAK,EAAEC,KAAK,EAAC;MAClBD,KAAK,CAACC,KAAK,GAAGA,KAAK;IACvB;EACJ,CAAC;EAEDG,OAAO,EAAE;IACLC,MAAM,CAACL,KAAK,EAAEI,OAAO,EAAC;MAClB,OAAOA,OAAO,CAACE,QAAQ,KAAK,EAAE,GAAG,KAAK,GAAG,IAAI;IACjD,CAAC;IACDA,QAAQ,CAACN,KAAK,EAAC;MACX,IAAGA,KAAK,CAACC,KAAK,EAAE,OAAOD,KAAK,CAACC,KAAK;MAClC,IAAIA,KAAK,GAAGM,cAAc,CAACC,OAAO,CAAC,OAAO,CAAC;MAC3C,IAAGP,KAAK,EAAE,OAAOA,KAAK;MACtB,OAAO,EAAE;IACb;EACJ,CAAC;EAEDQ,OAAO,EAAE;IACL,MAAMC,KAAK,CAACC,OAAO,EAAEC,WAAW,EAAE;MAC9B,IAAIC,QAAQ,GAAG,MAAMC,KAAK,CAAC,8BAA8B,EAAE;QACvDC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UAAC,cAAc,EAAE;QAAkB,CAAC;QAC7CC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAACP,WAAW;MACpC,CAAC,CAAC;MACF,IAAIC,QAAQ,CAACO,EAAE,EAAE;QACb,IAAIC,IAAI,GAAG,MAAMR,QAAQ,CAACQ,IAAI,EAAE;QAChCA,IAAI,GAAGA,IAAI,CAACC,UAAU,CAAC,GAAG,EAAC,EAAE,CAAC;QAC9BX,OAAO,CAACY,MAAM,CAAC,UAAU,EAAEF,IAAI,CAAC;QAChCV,OAAO,CAACY,MAAM,CAAC,OAAO,CAAC;QACvBhB,cAAc,CAACiB,OAAO,CAAC,OAAO,EAACH,IAAI,CAAC;MACxC,CAAC,MACG;QACA,IAAI,CAACI,SAAS,GAAG,IAAI;MACzB;IACJ;EACJ,CAAC;EAEDC,UAAU,EAAE;AAChB,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}